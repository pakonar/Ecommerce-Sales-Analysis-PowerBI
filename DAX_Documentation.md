# DAX Measures Documentation 

## > [ğŸ‡µğŸ‡± Polska wersja jÄ™zykowa poniÅ¼ej / Polish version below](#polska-wersja-jÄ™zykowa-pl)

# This document contains the complete set of DAX measures used in the project, categorized by analytical area.

---

## 1. Customer Analysis & Loyalty  

**Returning Customers**  
Calculates the number of customers who purchased in the current period AND have purchased at any time in the past.

```
Returning Customers =
VAR CurrentCustomers = VALUES('Online Retail'[CustomerID])
-- Creates a list of unique Customer IDs active in the CURRENT selection (e.g., November 2011).

VAR CurrentMonthStart = MIN('Calendar'[Date])
-- Gets the first date of the currently selected period (serves as a cutoff point for "the past").

VAR PastCustomers =
    CALCULATETABLE(
        -- Creates a virtual table in a modified filter context.
        VALUES('Online Retail'[CustomerID]),
        -- Gets a list of unique customers...
        ALL('Calendar'),
        -- ...but ignores all filters applied to the Calendar (looks at the entire history)...
        'Calendar'[Date] < CurrentMonthStart
        -- ...provided the purchase date is earlier than the start of the current period.
    )

RETURN
COUNTROWS(
    -- Counts rows in the resulting table.
    INTERSECT(CurrentCustomers, PastCustomers)
    -- INTERSECT returns the common part of two lists: customers present in both "Current" AND "Past" lists.
)
```
One-time Buyers  
Counts customers who have made exactly one purchase in the entire history of the store.
```
One-time Buyers =
COUNTROWS(
    -- Counts rows of the table created by the FILTER function.
    FILTER(
        VALUES('Online Retail'[CustomerID]),
        -- Iterates through every unique customer visible in the current context.

        CALCULATE(
            DISTINCTCOUNT('Online Retail'[InvoiceNo]),
            -- Counts unique invoice numbers for the specific customer...
            ALL('Calendar')
            -- ...but ignores the selected time period! Checks the customer's entire lifetime history.
        ) = 1
        -- Condition: Keep this customer only if their total historical invoice count is exactly 1.
    )
)
```
New Customers  
Number of customers who purchased in the current period but are not returning customers (first-time buyers).
```
New Customers =
[Total Customers] - [Returning Customers]
```
Retention Rate %  
Percentage of current customers who are loyal (returning).
```
Retention Rate % =
DIVIDE([Returning Customers], [Total Customers], 0)
```
Lifetime Retention Rate %  
Determines what percentage of customers visible in a period are repeat buyers over their entire history. This measure solves the issue of analyzing short time windows by looking at the customer's full lifecycle.
```
Lifetime Retention Rate % =
VAR TotalCust = [Total Customers]
-- Gets the count of all active customers in the selected context.

VAR OneTimeCust = [One-time Buyers]
-- Gets the count of customers who, in their ENTIRE history, purchased only once.

VAR RepeatCust = TotalCust - OneTimeCust
-- Calculates the remainder, i.e., customers who are not one-time buyers (must have bought at least twice).

RETURN
DIVIDE(RepeatCust, TotalCust, 0)
```
Purchase Frequency  
Average number of transactions per customer. A key loyalty metric â€“ higher values indicate stronger purchasing habits.
```
Purchase Frequency =
DIVIDE(
    [Transaction Count],
    -- Number of unique sales transactions (invoices).
    [Total Customers],
    -- Number of unique customers who made these purchases.
    0
)
```
2. Sales Performance  
% of GT Net Revenue  
Shows the percentage of total company sales generated by a specific product (or category). Key for Pareto analysis.
```
% of GT Net Revenue =
VAR CurrentProductRevenue = [Net Revenue (Inc. VAT)]
-- Assigns the sales value for the current row (e.g., specific product) to a variable.

VAR TotalGlobalRevenue =
    CALCULATE(
        [Net Revenue (Inc. VAT)],
        -- Calculates the same revenue measure...
        REMOVEFILTERS('Online Retail'[StockCode], 'Online Retail'[Description])
        -- ...but removes filters from Product Code and Description. This gives the sum of sales for ALL products.
    )

RETURN
DIVIDE(CurrentProductRevenue, TotalGlobalRevenue)
```
Average Order Value (AOV)  
Average value of a shopping basket (sales transactions only, excluding returns).
```
Average Order Value =
VAR TotalRevenueSales =
    CALCULATE(
        [Net Revenue (Inc. VAT)],
        -- Takes net revenue...
        'Online Retail'[Quantity] > 0
        -- ...but only for rows where quantity is positive (Sales, not Returns).
    )

VAR TotalInvoicesSales =
    CALCULATE(
        DISTINCTCOUNT('Online Retail'[InvoiceNo]),
        -- Counts unique invoice numbers...
        'Online Retail'[Quantity] > 0
    )

RETURN
DIVIDE(TotalRevenueSales, TotalInvoicesSales, 0)
```  
Average Units per Order  
Average number of items in a basket.
```
Average Units per Order =
VAR TotalUnitsSales =
    CALCULATE(
        SUM('Online Retail'[Quantity]),
        'Online Retail'[Quantity] > 0
    )

VAR TotalInvoicesSales =
    CALCULATE(
        DISTINCTCOUNT('Online Retail'[InvoiceNo]),
        'Online Retail'[Quantity] > 0
    )

RETURN
DIVIDE(TotalUnitsSales, TotalInvoicesSales, 0)
```
Gross Revenue  
Total sales value before deducting returns.
```
Gross Revenue =
CALCULATE(
    SUM('Online Retail'[Amount]),
    'Online Retail'[TransactionType] = "Sale"
)
```
3. Returns Analysis  
Return Value  
Total value of returned goods.
```
Return Value =
CALCULATE(
    SUM('Online Retail'[Amount]),
    'Online Retail'[TransactionType] = "Return"
)
```
Return Rate %  
Percentage of gross revenue lost due to returns.
```
Return Rate % =
DIVIDE(
    ABS([Return Value]),
    -- Takes the absolute value of returns (converts negative to positive).
    [Gross Revenue],
    0
)
```
4. Base Measures  
Transaction Count  
```
Transaction Count =
CALCULATE(
    DISTINCTCOUNT('Online Retail'[InvoiceNo]),
    'Online Retail'[TransactionType] = "Sale"
)
```
Total Customers  
```
Total Customers =
DISTINCTCOUNT('Online Retail'[CustomerID])
```
Total Products  
```
Total Products =
DISTINCTCOUNTNOBLANK('Online Retail'[StockCode])
```
##5. DAX Function Glossary   
CALCULATE: The most important function in DAX. Allows changing the calculation context (e.g., "calculate sales, but only for type 'Sale'").  
CALCULATETABLE: Same as CALCULATE, but returns a table instead of a single value. Used here to create the PastCustomers list.  
VAR ... RETURN: Variables. Allow storing calculation results for later use. Improves code readability and performance.  
ALL: A function that "removes filters". It says: "Ignore what the user selected in the slicer (e.g., date)".  
REMOVEFILTERS: A modern, more precise version of ALL used to remove filters from specific columns.  
VALUES: Returns a list of unique values from a column visible in the current filter.  
INTERSECT: Set function. Compares two lists and returns only elements present in both. Key for analyzing returning customers.  
DIVIDE: "Safe division". Protects against "divide by zero" errors.  
ABS (Absolute): Absolute value. Converts negative numbers to positive.  
DISTINCTCOUNT / NOBLANK: Counts unique occurrences. The NOBLANK version is better when data might contain empty rows. 


<a name="polska-wersja-jÄ™zykowa-pl"></a>ğŸ‡µğŸ‡± Polska wersja jÄ™zykowa (PL)  

##PoniÅ¼szy dokument zawiera kompletny zestaw miar jÄ™zyka DAX wykorzystanych w projekcie. Kod zostaÅ‚ podzielony na obszary analityczne.  
##1. Analiza i LojalnoÅ›Ä‡ KlientÃ³w (Customer Analysis & Loyalty)  

Returning Customers (PowracajÄ…cy Klienci)  
Oblicza liczbÄ™ klientÃ³w, ktÃ³rzy dokonali zakupu w bieÅ¼Ä…cym miesiÄ…cu ORAZ dokonali zakupu kiedykolwiek wczeÅ›niej.
```
Returning Customers =
VAR CurrentCustomers = VALUES('Online Retail'[CustomerID])
-- Tworzy listÄ™ unikalnych ID klientÃ³w, ktÃ³rzy kupili coÅ› w OBECNIE wybranym okresie (np. w Listopadzie 2011).

VAR CurrentMonthStart = MIN('Calendar'[Date])
-- Pobiera pierwszÄ… datÄ™ z obecnie wybranego okresu (sÅ‚uÅ¼y jako punkt odciÄ™cia "przeszÅ‚oÅ›ci").

VAR PastCustomers =
    CALCULATETABLE(
        -- Tworzy wirtualnÄ… tabelÄ™ w zmienionym kontekÅ›cie filtrÃ³w.
        VALUES('Online Retail'[CustomerID]),
        -- Pobiera listÄ™ unikalnych klientÃ³w...
        ALL('Calendar'),
        -- ...ale ignoruje wszystkie filtry naÅ‚oÅ¼one na kalendarz (patrzy na caÅ‚Ä… historiÄ™)...
        'Calendar'[Date] < CurrentMonthStart
        -- ...pod warunkiem, Å¼e data zakupu jest wczeÅ›niejsza niÅ¼ poczÄ…tek obecnego okresu.
    )

RETURN
COUNTROWS(
    -- Zlicza wiersze w tabeli wynikowej.
    INTERSECT(CurrentCustomers, PastCustomers)
    -- Funkcja INTERSECT zwraca czÄ™Å›Ä‡ wspÃ³lnÄ… dwÃ³ch list: klientÃ³w, ktÃ³rzy sÄ… na liÅ›cie "Obecni" I na liÅ›cie "Przeszli".
)
```
One-time Buyers (Jednorazowi Klienci)  
Liczy klientÃ³w, ktÃ³rzy w caÅ‚ej historii sklepu zrobili zakupy tylko raz.
```
One-time Buyers =
COUNTROWS(
    -- Zlicza wiersze tabeli, ktÃ³ra powstanie w wyniku funkcji FILTER.
    FILTER(
        VALUES('Online Retail'[CustomerID]),
        -- Iteruje (przechodzi) przez kaÅ¼dego unikalnego klienta widocznego w obecnym kontekÅ›cie.

        CALCULATE(
            DISTINCTCOUNT('Online Retail'[InvoiceNo]),
            -- Liczy unikalne numery faktur dla danego klienta...
            ALL('Calendar')
            -- ...ale ignoruje wybrany okres czasu! Sprawdza caÅ‚Ä… historiÄ™ Å¼ycia klienta.
        ) = 1
        -- Warunek: JeÅ›li liczba faktur w caÅ‚ej historii wynosi dokÅ‚adnie 1, zachowaj tego klienta.
    )
)
```  
New Customers (Nowi Klienci)  
Liczba klientÃ³w, ktÃ³rzy kupili coÅ› w tym okresie, ale nie sÄ… powracajÄ…cy (czyli kupujÄ… pierwszy raz).
```
New Customers =
[Total Customers] - [Returning Customers]
```
Retention Rate % (WskaÅºnik Retencji)  
Jaki procent obecnych klientÃ³w to klienci lojalni (powracajÄ…cy).
```
Retention Rate % =
DIVIDE([Returning Customers], [Total Customers], 0)
-- Dzieli liczbÄ™ powracajÄ…cych przez ogÃ³lnÄ… liczbÄ™ klientÃ³w.
```    
Lifetime Retention Rate % (WskaÅºnik PowracajÄ…cych KlientÃ³w - CaÅ‚kowity)  
OkreÅ›la, jaki procent klientÃ³w widocznych w danym okresie to osoby, ktÃ³re w caÅ‚ej historii wspÃ³Å‚pracy z firmÄ… dokonaÅ‚y wiÄ™cej niÅ¼ jednego zakupu. Miara ta rozwiÄ…zuje problem analizy w krÃ³tkich oknach czasowych, patrzÄ…c na "cykl Å¼ycia" klienta.
```
Lifetime Retention Rate % =
VAR TotalCust = [Total Customers]
-- Pobiera liczbÄ™ wszystkich klientÃ³w aktywnych w wybranym kontekÅ›cie (np. w danym roku).

VAR OneTimeCust = [One-time Buyers]
-- Pobiera liczbÄ™ klientÃ³w, ktÃ³rzy w CAÅEJ historii (dziÄ™ki funkcji ALL w mierze bazowej) kupili tylko raz.

VAR RepeatCust = TotalCust - OneTimeCust
-- Oblicza resztÄ™, czyli klientÃ³w, ktÃ³rzy nie sÄ… jednorazowi (zatem musieli kupiÄ‡ min. 2 razy).

RETURN
DIVIDE(RepeatCust, TotalCust, 0)
-- Dzieli liczbÄ™ powracajÄ…cych przez ogÃ³Å‚ klientÃ³w, dajÄ…c procent lojalnej bazy (np. 70%).
```
Purchase Frequency (CzÄ™stotliwoÅ›Ä‡ ZakupÃ³w)  
MÃ³wi nam, ile Å›rednio transakcji dokonuje jeden klient. Jest to kluczowy wskaÅºnik lojalnoÅ›ci â€“ im wyÅ¼szy wynik, tym silniejszy nawyk zakupowy majÄ… klienci.
```
Purchase Frequency =
DIVIDE(
    [Transaction Count],
    -- Liczba unikalnych transakcji sprzedaÅ¼y (faktur).
    [Total Customers],
    -- Liczba unikalnych klientÃ³w, ktÃ³rzy dokonali tych zakupÃ³w.
    0
    -- Zabezpieczenie przed dzieleniem przez zero.
)
```
2. Analiza SprzedaÅ¼y i ProduktÃ³w (Sales Performance)    
% of GT Net Revenue (UdziaÅ‚ w CaÅ‚kowitym Przychodzie)  
Pokazuje, jaki procent caÅ‚kowitej sprzedaÅ¼y firmy stanowi sprzedaÅ¼ danego produktu (lub kategorii). Kluczowe do analizy Pareto.
```
% of GT Net Revenue =
VAR CurrentProductRevenue = [Net Revenue (Inc. VAT)]
-- Przypisuje do zmiennej wartoÅ›Ä‡ sprzedaÅ¼y dla bieÅ¼Ä…cego wiersza (np. konkretnego produktu na wykresie).

VAR TotalGlobalRevenue =
    CALCULATE(
        [Net Revenue (Inc. VAT)],
        -- Oblicza tÄ™ samÄ… miarÄ™ przychodu...
        REMOVEFILTERS('Online Retail'[StockCode], 'Online Retail'[Description])
        -- ...ale usuwa filtry z kodu i opisu produktu. DziÄ™ki temu otrzymujemy sumÄ™ sprzedaÅ¼y WSZYSTKICH produktÃ³w (mianownik).
    )

RETURN
DIVIDE(CurrentProductRevenue, TotalGlobalRevenue)
-- Bezpieczne dzielenie: (SprzedaÅ¼ Produktu) / (SprzedaÅ¼ CaÅ‚kowita).
```
Average Order Value (AOV - Åšrednia WartoÅ›Ä‡ ZamÃ³wienia)  
Åšrednia wartoÅ›Ä‡ koszyka zakupowego (tylko dla transakcji sprzedaÅ¼y, bez zwrotÃ³w).
```
Average Order Value =
VAR TotalRevenueSales =
    CALCULATE(
        [Net Revenue (Inc. VAT)],
        -- Bierze przychÃ³d netto...
        'Online Retail'[Quantity] > 0
        -- ...ale tylko dla wierszy, gdzie iloÅ›Ä‡ jest dodatnia (czyli to sprzedaÅ¼, a nie zwrot).
    )

VAR TotalInvoicesSales =
    CALCULATE(
        DISTINCTCOUNT('Online Retail'[InvoiceNo]),
        -- Liczy unikalne numery faktur...
        'Online Retail'[Quantity] > 0
        -- ...rÃ³wnieÅ¼ tylko dla transakcji sprzedaÅ¼y (Å¼eby nie liczyÄ‡ faktur korygujÄ…cych jako zamÃ³wieÅ„).
    )

RETURN
DIVIDE(TotalRevenueSales, TotalInvoicesSales, 0)
-- Dzieli przychÃ³d przez liczbÄ™ zamÃ³wieÅ„. JeÅ›li brak zamÃ³wieÅ„, zwraca 0.
```
Average Units per Order (Åšrednia liczba sztuk w zamÃ³wieniu)  
Ile jest Å›rednio produktÃ³w w koszyku.
```
Average Units per Order =
VAR TotalUnitsSales =
    CALCULATE(
        SUM('Online Retail'[Quantity]),
        -- Sumuje iloÅ›Ä‡ sztuk...
        'Online Retail'[Quantity] > 0
        -- ...tylko dla sprzedaÅ¼y (ignoruje ujemne iloÅ›ci ze zwrotÃ³w).
    )

VAR TotalInvoicesSales =
    CALCULATE(
        DISTINCTCOUNT('Online Retail'[InvoiceNo]),
        -- Liczy liczbÄ™ zamÃ³wieÅ„ (tak samo jak w AOV)...
        'Online Retail'[Quantity] > 0
    )

RETURN
DIVIDE(TotalUnitsSales, TotalInvoicesSales, 0)
-- Dzieli liczbÄ™ sztuk przez liczbÄ™ zamÃ³wieÅ„.
```
Gross Revenue (PrzychÃ³d Brutto)  
CaÅ‚kowita wartoÅ›Ä‡ sprzedaÅ¼y przed odjÄ™ciem zwrotÃ³w.
```
Gross Revenue =
CALCULATE(
    SUM('Online Retail'[Amount]),
    -- Sumuje kolumnÄ™ z kwotami...
    'Online Retail'[TransactionType] = "Sale"
    -- ...biorÄ…c pod uwagÄ™ tylko wiersze oznaczone jako "Sale" (SprzedaÅ¼).
)
```
3. Analiza ZwrotÃ³w (Returns Analysis)  
Return Value (WartoÅ›Ä‡ ZwrotÃ³w)  
ÅÄ…czna kwota zwrÃ³conych towarÃ³w.
```
Return Value =
CALCULATE(
    SUM('Online Retail'[Amount]),
    -- Sumuje kolumnÄ™ z kwotami...
    'Online Retail'[TransactionType] = "Return"
    -- ...biorÄ…c pod uwagÄ™ tylko wiersze oznaczone jako "Return" (Zwrot).
)
```
Return Rate % (WskaÅºnik ZwrotÃ³w)  
Jaki procent przychodu brutto tracimy przez zwroty.
```
Return Rate % =
DIVIDE(
    ABS([Return Value]),
    -- Bierze wartoÅ›Ä‡ bezwzglÄ™dnÄ… zwrotÃ³w (zamienia liczbÄ™ ujemnÄ… na dodatniÄ…, np. -100 na 100)...
    [Gross Revenue],
    -- ...i dzieli przez przychÃ³d brutto.
    0
    -- W razie bÅ‚Ä™du zwraca 0.
)
```
4. Podstawowe Liczniki (Base Measures)  
Transaction Count (Liczba Transakcji)
```
Transaction Count =
CALCULATE(
    DISTINCTCOUNT('Online Retail'[InvoiceNo]),
    -- Liczy unikalne numery faktur...
    'Online Retail'[TransactionType] = "Sale"
    -- ...tylko dla sprzedaÅ¼y (ignoruje korekty).
)
```  
Total Customers (Liczba KlientÃ³w)
```
Total Customers =
DISTINCTCOUNT('Online Retail'[CustomerID])
-- Liczy unikalne ID klientÃ³w w bieÅ¼Ä…cym kontekÅ›cie.
```
**Total Products (Liczba ProduktÃ³w)**
```
Total Products =
DISTINCTCOUNTNOBLANK('Online Retail'[StockCode])
-- Liczy unikalne kody produktÃ³w, ignorujÄ…c puste wartoÅ›ci (BLANK).
```
# 5. SÅ‚ownik uÅ¼ytych funkcji DAX  
CALCULATE: NajwaÅ¼niejsza funkcja w DAX. Pozwala zmieniÄ‡ kontekst obliczeÅ„ (np. "policz sprzedaÅ¼, ale tylko dla typu 'Sale'").  
CALCULATETABLE: To samo co CALCULATE, ale zwraca caÅ‚Ä… tabelÄ™, a nie jednÄ… liczbÄ™. UÅ¼yte do stworzenia listy PastCustomers.  
VAR ... RETURN: Zmienne. PozwalajÄ… zapisaÄ‡ wynik obliczenia, nazwaÄ‡ go i uÅ¼yÄ‡ pÃ³Åºniej. PoprawiajÄ… czytelnoÅ›Ä‡ i wydajnoÅ›Ä‡ kodu.  
ALL: Funkcja "usuwajÄ…ca filtry". MÃ³wi: "Ignoruj to, co uÅ¼ytkownik wybraÅ‚ we fragmentatorze (np. datÄ™)".  
REMOVEFILTERS: NowoczeÅ›niejsza, bardziej precyzyjna wersja ALL sÅ‚uÅ¼Ä…ca do usuwania filtrÃ³w z konkretnych kolumn (uÅ¼yta w % of GT).  
VALUES: Zwraca listÄ™ unikalnych wartoÅ›ci z kolumny, widocznych w obecnym filtrze.  
INTERSECT: Funkcja zbiorÃ³w. PorÃ³wnuje dwie listy i zwraca tylko te elementy, ktÃ³re wystÄ™pujÄ… w obu. Kluczowa do analizy powracajÄ…cych klientÃ³w.  
DIVIDE: "Bezpieczne dzielenie". Chroni przed bÅ‚Ä™dem "dzielenie przez zero" (np. gdy w danym dniu nie byÅ‚o sprzedaÅ¼y).  
ABS (Absolute): WartoÅ›Ä‡ bezwzglÄ™dna. Zamienia liczby ujemne na dodatnie (przydatne przy zwrotach).  
DISTINCTCOUNT / DISTINCTCOUNTNOBLANK: Zlicza unikalne wystÄ…pienia. Wersja NOBLANK jest lepsza, gdy w danych mogÄ… byÄ‡ puste wiersze.
